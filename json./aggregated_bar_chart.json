{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Top 30 countries by per-capita energy (kWh/person) with clickable legend highlight.",
  "title": "Per-Capita Energy Use â€” Top 30",
  "data": {
    "url": "https://raw.githubusercontent.com/ananya21233/FIT3179_Assignment_2/main/data/global_2.csv"
  },
  "transform": [
    { "calculate": "toNumber(datum.Value)", "as": "Metric" },
    { "window": [{"op": "rank", "as": "rank"}], "sort": [{"field": "Metric", "order": "descending"}] },
    { "filter": "datum.rank <= 30" }
  ],
  "params": [
    {
      "name": "legendSel",
      "select": { "type": "point", "encodings": ["color"] },
      "bind": "legend"
    }
  ],
  "mark": { "type": "bar", "cornerRadiusEnd": 6 },
  "width": 900,
  "height": { "step": 24 },
  "encoding": {
    "y": { "field": "Entity", "type": "nominal", "sort": "-x", "title": null },
    "x": { "field": "Metric", "type": "quantitative", "title": "kWh per person", "axis": { "format": ",.0f" } },
    "color": {
      "field": "Metric",
      "type": "quantitative",
      "bin": { "maxbins": 5 },
      "scale": { "scheme": "reds" },
      "legend": { "title": "kWh/person (binned)" }
    },
    "opacity": { "condition": { "param": "legendSel", "value": 1 }, "value": 0.25 },
    "tooltip": [
      { "field": "Entity", "title": "Country" },
      { "field": "Metric", "title": "Per-capita (kWh/person)", "format": ",.0f" }
    ]
  },
  "config": { "view": { "stroke": null }, "background": "#f9fafb" }
}